function Validate-MDAProfile { [CmdletBinding()] param([Parameter(Mandatory)][string]$Path); if (-not (Test-Path $Path)) { throw "Profile not found: $Path" }; $obj = Get-Content -Path $Path -Raw | ConvertFrom-Json; $res = Validate-ProfileObject -Profile $obj; foreach($e in $res.Errors){ Write-Log -Message ("Profile error: " + $e) -Level ERROR }; foreach($w in $res.Warnings){ Write-Log -Message ("Profile warning: " + $w) -Level WARN }; Write-Log -Message ("Profile validation: " + ($(if($res.IsValid){'OK'}else{'FAILED'}))) -Level INFO; return $res }
